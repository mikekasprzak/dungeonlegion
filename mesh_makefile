# - ------------------------------------------------------------------------ - #
TARGET				:=	obj/_MeshUpdated
# - ------------------------------------------------------------------------ - #
SRC					:=	SrcContent/meshes
DEST				:=	Content/meshes
# - ------------------------------------------------------------------------ - #
TreeTool			:=	Tools/TreeTool

TextureTool			:=	Tools/TextureTool
LZMA				:=	Tools/lzma
Blender				:=	"$(PROGRAMFILES)/Blender Foundation/Blender/blender"
# - ------------------------------------------------------------------------ - #
ART_FILES			:=	$(shell $(TreeTool) $(SRC) .blend)

IGNORE_LIST			:=	
# - ------------------------------------------------------------------------ - #
ART_FILES			:=	$(filter-out $(IGNORE_LIST),$(ART_FILES))
# - ------------------------------------------------------------------------ - #
# To support more ways of adapting files, add them here. Before if a PNG variant. #
ART_FILES			:=	$(ART_FILES:.blend=.pme)
# - ------------------------------------------------------------------------ - #
ART_FILES			:=	$(subst $(SRC)/,$(DEST)/,$(ART_FILES))
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
$(TARGET): makedirs $(ART_FILES)
	@touch $@
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
force:
	touch $(shell $(TreeTool) $(SRC) .blend)
# - ------------------------------------------------------------------------ - #
clean:
	-rm -r $(TARGET)
# - ------------------------------------------------------------------------ - #
makedirs:
	mkdir -p $(sort $(dir $(ART_FILES)) )
# - ------------------------------------------------------------------------ - #
phony: clean makedirs force
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
$(DEST)/%.pme: $(SRC)/%.blend
	BLENDER_TARGET=$@ $(Blender) -b $< -P Tools/BlenderExporter/pme_export.py
# - ------------------------------------------------------------------------ - #
