# - ------------------------------------------------------------------------ - #
TARGET				:=	output/DungeonLegion.exe
# - ------------------------------------------------------------------------ - #
DEFINES				:=	-DSDL_BUILD -DWINDOWS_BUILD -DWINDOW_TITLE=\"Dungeon\ Legion\"
INCLUDES			:=	-Isrc -Isrc/GLGraphics -Isrc/External
# - ------------------------------------------------------------------------ - #
LIBRARIES			:=	-Lmingw32/lib -lmingw32 -lSDLmain -lSDL \
						-lkernel32 -luser32 -lgdi32 -lcomdlg32 -lole32 -ldinput \
						-lddraw -ldxguid -lwinmm -ldsound -lopengl32 -lglu32 \
#						-lSDL_mixer \
#						-mwindows

IGNORE_LIST			:=	src/UnixTime.cpp
# - ------------------------------------------------------------------------ - #
TreeTool			:=	Tools/TreeTool
# - ------------------------------------------------------------------------ - #
CODE_FILES			:=	$(shell $(TreeTool) src .cpp .c)
H_FILES				:=	$(shell $(TreeTool) src .h)
# - ------------------------------------------------------------------------ - #
.O_FILES			:=	$(addprefix obj/,$(addsuffix .o,$(filter-out $(IGNORE_LIST),$(CODE_FILES))))
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
$(TARGET): makedirs $(H_FILES) $(.O_FILES)
	g++ $(DEFINES) $(INCLUDES) $(.O_FILES) -o $@ $(LIBRARIES)
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
run: $(TARGET)
	./$(TARGET)
# - ------------------------------------------------------------------------ - #
clean:
	-rm $(.O_FILES) $(.O_FILES:.o=.o.d)
# - ------------------------------------------------------------------------ - #
makedirs:
	mkdir -p $(sort $(dir $(.O_FILES)))
# - ------------------------------------------------------------------------ - #
phony: run clean makedirs
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
obj/%.c.o: %.c
	gcc $(DEFINES) $(INCLUDES) -MMD -MF $@.d -c $< -o $@
# - ------------------------------------------------------------------------ - #
obj/%.cpp.o: %.cpp
	g++ $(DEFINES) $(INCLUDES) -MMD -MF $@.d -c $< -o $@
# - ------------------------------------------------------------------------ - #


# - ------------------------------------------------------------------------ - #
-include $(.O_FILES:.o=.o.d)
# - ------------------------------------------------------------------------ - #
	